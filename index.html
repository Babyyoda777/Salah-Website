<!DOCTYPE html>
<html lang="en" >

<head>
    <script src="adhan.umd.js"></script>
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/location-picker/dist/location-picker.min.js"></script>
    <link rel="shortcut icon" href="./logo.png" type="image/x-icon">
    <meta name="description" content="Salah timings based on your location.">
    <title>Salaam: Location-based prayer timings.</title>
    <link rel="manifest" href="manifest.json">

    <link rel="stylesheet" href="./styles.css">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Salaam">
    <meta name="apple-mobile-web-app-title" content="Salaam">
    <meta name="theme-color" content="#b9ebf5">
    <meta name="msapplication-navbutton-color" content="#b9ebf5">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="msapplication-starturl" content="/">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="icon" sizes="1024x1024" href="logo.png">
    <link rel="apple-touch-icon" sizes="1024x1024" href="logo.png">
</head>

<body class="bg" onload="getLocation()">
    <div class="flex justify-center sticky top-0 w-full z-50 ">
        <nav class="nav backdrop-blur-2xl bg-[rgba(31,32,35,.5)] flex flex-grow flex-row items-center max-w-xl mt-4 mx-4 px-5 py-4 rounded-full shadow-sm">
            <img alt="SideStore Logo" src="./logo.svg" style="height: 3.5rem;">
            <div class="flex-grow"></div>
            <div class="flex gap-3 justify-center">
                <a title="GitHub" href="https://github.com/babyyoda777/Salaam-iOS" target="_blank" class="flex h-6 justify-center text-gray-300 w-6">
                    <svg fill="currentColor" viewBox="0 0 496 512">
                        <path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/>
                    </svg>
                </a>
            </div>
        </nav>
    </div>
    <section class="main">
        <p class="title">ٱلسَّلَامُ عَلَيْكُمْ</p>
        <div class="prayer">
            <h3 class="child">Current prayer:</h3>
            <p class="child2" id="current"></p>
        </div>
        <div class="prayer">
            <h3 class="child">Fajr:</h3>
            <p class="child2" id="fajr"></p>
        </div>
        <div class="prayer">
            <h3 class="child">Sunrise:</h3>
            <p class="child2" id="sunrise"></p>
        </div>
        <div class="prayer">
            <h3 class="child">Zuhr:</h3>
            <p class="child2" id="zuhr"></p>
        </div>
        <div class="prayer">
            <h3 class="child">Asr:</h3>
            <p class="child2" id="asr"></p>
        </div>
        <div class="prayer">
            <h3 class="child">Maghrib:</h3>
            <p class="child2" id="maghrib"></p>
        </div>
        <div class="prayer">
            <h3 class="child">Isha:</h3>
            <p class="child2" id="isha"></p>
        </div>
    </section>
    <pre><script type="text/javascript">


        function prayerName(prayer) {
            if (prayer == adhan.Prayer.Fajr) {
                return "Fajr";
            } else if (prayer == adhan.Prayer.Sunrise) {
                return "Sunrise";
            } else if (prayer == adhan.Prayer.Dhuhr) {
                return "Dhuhr";
            } else if (prayer == adhan.Prayer.Asr) {
                return "Asr";
            } else if (prayer == adhan.Prayer.Maghrib) {
                return "Maghrib";
            } else if (prayer == adhan.Prayer.Isha) {
                return "Isha";
            } else if (prayer == adhan.Prayer.None) {
                return "None";
            }
        }


    </script></pre>
    <script>

        function getLocation() {
            if (navigator.geolocation) {
                alert("If you decline location permissions, the default times will show for London.");
                navigator.geolocation.getCurrentPosition(showPosition, handleError);
                var date = new Date();
            var coordinates = new adhan.Coordinates( 51, 0.3);
            var params = adhan.CalculationMethod.NorthAmerica();
            params.madhab = adhan.Madhab.Hanafi;
            params.adjustments.sunrise = -1
            params.adjustments.dhuhr = 4
            params.adjustments.asr = 1
            params.adjustments.isha = -18
            var prayerTimes = new adhan.PrayerTimes(coordinates, date, params);

            // document.write('Prayer times for ' + date.getFullYear() + '/' + (date.getMonth() + 1) + '/' + date.getDate() + '\n');
            // document.write('Fajr: ' + prayerTimes.fajr + '\n');
            // document.write('Sunrise: ' + prayerTimes.sunrise + '\n');
            // document.write('Dhuhr: ' + prayerTimes.dhuhr + '\n');
            // document.write('Asr: ' + prayerTimes.asr + '\n');
            // document.write('Maghrib: ' + prayerTimes.maghrib + '\n');
            // document.write('Isha: ' + prayerTimes.isha + '\n');

            // document.write('\nCurrent Prayer: ' + prayerName(prayerTimes.currentPrayer()) + '\n');
            document.getElementById("fajr").innerHTML = prayerTimes.fajr.toLocaleTimeString().slice(0, -3);
            document.getElementById("sunrise").innerHTML = prayerTimes.sunrise.toLocaleTimeString().slice(0, -3);
            document.getElementById("zuhr").innerHTML = prayerTimes.dhuhr.toLocaleTimeString().slice(0, -3);
            document.getElementById("asr").innerHTML = prayerTimes.asr.toLocaleTimeString().slice(0, -3);
            document.getElementById("maghrib").innerHTML = prayerTimes.maghrib.toLocaleTimeString().slice(0, -3);
            document.getElementById("isha").innerHTML = prayerTimes.isha.toLocaleTimeString().slice(0, -3);
            document.getElementById("current").innerHTML = prayerName(prayerTimes.currentPrayer());
            } else {
            console.error("Geolocation is not supported by this browser.");
            }
        }


        function handleError(error) {
            let errorStr;
            switch (error.code) {
                case error.PERMISSION_DENIED:
                    errorStr = 'User denied the request for Geolocation.';
                    break;
                case error.POSITION_UNAVAILABLE:
                    errorStr = 'Location information is unavailable.';
                    break;
                case error.TIMEOUT:
                    errorStr = 'The request to get user location timed out.';
                    break;
                case error.UNKNOWN_ERROR:
                    errorStr = 'An unknown error occurred.';
                    break;
                default:
                    errorStr = 'An unknown error occurred.';
            }
            console.error('Error occurred: ' + errorStr);
        }

        function showPosition(position) {

            var latitude = 51
            var longitude = 0.3
            var date = new Date();
            var coordinates = new adhan.Coordinates( position.coords.latitude, position.coords.longitude);
            var params = adhan.CalculationMethod.NorthAmerica();
            params.madhab = adhan.Madhab.Hanafi;
            params.adjustments.sunrise = -1
            params.adjustments.dhuhr = 4
            params.adjustments.asr = 1
            params.adjustments.isha = -18
            var prayerTimes = new adhan.PrayerTimes(coordinates, date, params);

            // document.write('Prayer times for ' + date.getFullYear() + '/' + (date.getMonth() + 1) + '/' + date.getDate() + '\n');
            // document.write('Fajr: ' + prayerTimes.fajr + '\n');
            // document.write('Sunrise: ' + prayerTimes.sunrise + '\n');
            // document.write('Dhuhr: ' + prayerTimes.dhuhr + '\n');
            // document.write('Asr: ' + prayerTimes.asr + '\n');
            // document.write('Maghrib: ' + prayerTimes.maghrib + '\n');
            // document.write('Isha: ' + prayerTimes.isha + '\n');

            // document.write('\nCurrent Prayer: ' + prayerName(prayerTimes.currentPrayer()) + '\n');
            document.getElementById("fajr").innerHTML = prayerTimes.fajr.toLocaleTimeString().slice(0, -3);
            document.getElementById("sunrise").innerHTML = prayerTimes.sunrise.toLocaleTimeString().slice(0, -3);
            document.getElementById("zuhr").innerHTML = prayerTimes.dhuhr.toLocaleTimeString().slice(0, -3);
            document.getElementById("asr").innerHTML = prayerTimes.asr.toLocaleTimeString().slice(0, -3);
            document.getElementById("maghrib").innerHTML = prayerTimes.maghrib.toLocaleTimeString().slice(0, -3);
            document.getElementById("isha").innerHTML = prayerTimes.isha.toLocaleTimeString().slice(0, -3);
            document.getElementById("current").innerHTML = prayerName(prayerTimes.currentPrayer());
            console.log(`Latitude: ${position.coords.latitude}, longitude: ${position.coords.longitude}`);
        }
    </script>
</body>

</html>